<!DOCTYPE html>
<html lang="en">
<head>
<!-- 26 Apr. 2024 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>NeuroFlame: Fast Learning And Modeling Engine</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Alexandre Mahrach">
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/js/readtheorg.js"></script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<main id="content">
<header>
<h1 class="title">NeuroFlame: Fast Learning And Modeling Engine</h1>
</header><nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org73af6b4">Introduction</a></li>
<li><a href="#org7818453">Installation</a></li>
<li><a href="#orgeac35a0">Project Structure</a></li>
<li><a href="#org7888a54">Network Dynamics</a>
<ul>
<li>
<ul>
<li><a href="#org5db1ef5">Dynamics</a></li>
<li><a href="#org886d0f7">Connectivity</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org93b7762">Network Simulations</a>
<ul>
<li><a href="#org3346688">Basic Usage</a></li>
<li><a href="#orga62a82a">Parallel Network Simulations</a></li>
</ul>
</li>
<li><a href="#org9eae4c2">Network Training</a></li>
<li><a href="#orge89b3d5">Tutorials</a>
<ul>
<li><a href="#org51bbf95">Balanced Networks</a></li>
<li><a href="#org88b3941">Multistability</a></li>
<li><a href="#org2820c64">Short Term Plasticity</a></li>
<li><a href="#org61b3696">Behavioral Tasks</a></li>
<li><a href="#org9273547">Serial Bias</a></li>
</ul>
</li>
<li><a href="#org564e8b2">Contributing</a></li>
</ul>
</div>
</nav>

<figure id="orga1bee26">
<img src="./neuroflame.jpeg" alt="neuroflame.jpeg" width="400px">

</figure>

<p>
Copyright Â© 2024 by Melanie Tschiersch. All rights reserved.
</p>

<section id="outline-container-org73af6b4" class="outline-2">
<h2 id="org73af6b4">Introduction</h2>
<div class="outline-text-2" id="text-org73af6b4">
<p>
This package provides an implementation of a recurrent neural network trainer and simulator with Pytorch.
Networks can have multiple neural populations with different connectivity types (all-to-all, sparse) and structures (feature selective, spatially tuned, low rank).
</p>

<p>
Networks models can be trained in a unsupervised or supervised manner just as vanilla RNNs in Pytorch.
</p>
</div>
</section>

<section id="outline-container-org7818453" class="outline-2">
<h2 id="org7818453">Installation</h2>
<div class="outline-text-2" id="text-org7818453">
<div class="org-src-container">
<pre class="src src-sh">pip install -r requirements.txt
</pre>
</div>

<p>
or alternatively using conda (I recommend using mamba&rsquo;s <a href="https://github.com/conda-forge/miniforge">miniforge</a>, a c++ conda implementation)
</p>

<div class="org-src-container">
<pre class="src src-sh">mamba install --file conda_requirements.txt
</pre>
</div>
</div>
</section>

<section id="outline-container-orgeac35a0" class="outline-2">
<h2 id="orgeac35a0">Project Structure</h2>
<div class="outline-text-2" id="text-orgeac35a0">
<div class="org-src-container">
<pre class="src src-sh">.
&#9500;&#9472;&#9472; conf  <span class="org-comment-delimiter"># </span><span class="org-comment">contains configuration files in yaml format.</span>
&#9474;&#160;&#160; &#9500;&#9472;&#9472; *.yml
&#9500;&#9472;&#9472; notebooks  <span class="org-comment-delimiter"># </span><span class="org-comment">contains ipython notebooks.</span>
&#9474;&#160;&#160; &#9500;&#9472;&#9472; setup.py
&#9474;&#160;&#160; &#9492;&#9472;&#9472; *.ipynb
&#9500;&#9472;&#9472; org  <span class="org-comment-delimiter"># </span><span class="org-comment">contains org notebooks.</span>
&#9474;&#160;&#160; &#9500;&#9472;&#9472; /doc/*.org
&#9474;&#160;&#160; &#9492;&#9472;&#9472; *.org
&#9500;&#9472;&#9472; src  <span class="org-comment-delimiter"># </span><span class="org-comment">contains source code.</span>
&#9474;&#160;&#160; &#9500;&#9472;&#9472; activation.py  <span class="org-comment-delimiter"># </span><span class="org-comment">contains custom activation functions.</span>
&#9474;&#160;&#160; &#9500;&#9472;&#9472; connectivity.py  <span class="org-comment-delimiter"># </span><span class="org-comment">contains custom connectivity profiles.</span>
&#9474;&#160;&#160; &#9500;&#9472;&#9472; decode.py
&#9474;&#160;&#160; &#9500;&#9472;&#9472; lif_network.py  <span class="org-comment-delimiter"># </span><span class="org-comment">implementation of a LIF network.</span>
&#9474;&#160;&#160; &#9500;&#9472;&#9472; lif_neuron.py
&#9474;&#160;&#160; &#9500;&#9472;&#9472; lr_utils.py  <span class="org-comment-delimiter"># </span><span class="org-comment">utils for low rank networks.</span>
&#9474;&#160;&#160; &#9500;&#9472;&#9472; network.py  <span class="org-comment-delimiter"># </span><span class="org-comment">core of the project.</span>
&#9474;&#160;&#160; &#9500;&#9472;&#9472; plasticity.py  <span class="org-comment-delimiter"># </span><span class="org-comment">contains STP.</span>
&#9474;&#160;&#160; &#9500;&#9472;&#9472; plot_utils.py
&#9474;&#160;&#160; &#9500;&#9472;&#9472; sparse.py  <span class="org-comment-delimiter"># </span><span class="org-comment">utils for large sparse matrices.</span>
&#9474;&#160;&#160; &#9500;&#9472;&#9472; stimuli.py  <span class="org-comment-delimiter"># </span><span class="org-comment">contains custom stimuli for behavioral tasks.</span>
&#9474;&#160;&#160; &#9500;&#9472;&#9472; train.py  <span class="org-comment-delimiter"># </span><span class="org-comment">utils to train networks.</span>
&#9492;&#9472;&#9472; &#9492;&#9472;&#9472; utils.py
</pre>
</div>
</div>
</section>

<section id="outline-container-org7888a54" class="outline-2">
<h2 id="org7888a54"><a href="file:///LeonCarmin/NeuroFlame/src/branch/main/org/doc/dynamics.html">Network Dynamics</a></h2>
<div class="outline-text-2" id="text-org7888a54">
</div>
<div id="outline-container-org5db1ef5" class="outline-4">
<h4 id="org5db1ef5">Dynamics</h4>
<div class="outline-text-4" id="text-org5db1ef5">
</div>
<ul class="org-ul">
<li><a id="org9306c6f"></a>Currents<br>
<div class="outline-text-5" id="text-org9306c6f">
<p>
Neuron \(i\) in population \(A\) has a reccurent input \(h^A_i\),
</p>

<p>
\[  \tau_{syn} \frac{dh_i}{dt}(t) = - h_i(t) + \sum_j J_{ij} h_j(t) \]
</p>

<p>
or not
</p>

<p>
\[ h^A_i(t) = \sum_{jB} J^{AB}_{ij} h_j(t) \]
</p>
</div>
</li>

<li><a id="orgf0f8370"></a>Rates<br>
<div class="outline-text-5" id="text-orgf0f8370">
<p>
The models can have rate dynamics (setting <b>RATE_DYN</b> to 1 in the configuration file):
</p>

<p>
\[ \tau_A \frac{d r^A_i}{dt}(t) = - r^A_i(t) + \Phi( \sum_{jB} J^{AB}_{ij} h^{AB}_j(t) + h^A_{ext}(t)) \]
</p>

<p>
Here, \(r_i\) is the rate of unit \(i\) in population \(A\)
</p>

<p>
otherwise rates will be instantaneous:
</p>

<p>
\[ r^A_i(t) = \Phi(\sum_{jB} J^{AB}_{ij} h_j(t) + h^A_{ext}(t)) \]
</p>

<p>
Here \(\Phi\) is the transfer function defined in <b>src/activation.py</b> and can be set to a threshold linear, a sigmoid or a non linear function (Brunel et al., 2003).
</p>
</div>
</li>
</ul>
</div>

<div id="outline-container-org886d0f7" class="outline-4">
<h4 id="org886d0f7">Connectivity</h4>
<div class="outline-text-4" id="text-org886d0f7">
<p>
The connectivities available in NeuroFlame are described <a href="file:///LeonCarmin/NeuroFlame/src/branch/main/org/tests/connectivity.html">here</a>.
</p>

<p>
Probability of connection from population B to A:
</p>
</div>

<ul class="org-ul">
<li><a id="org4a4f38b"></a>Sparse Nets<br>
<div class="outline-text-5" id="text-org4a4f38b">
<p>
by default it is a sparse net
</p>

<p>
\[ P_{ij}^{AB} = \frac{K_B}{N_B} \]
</p>

<p>
otherwise
it can be cosine
</p>

<p>
\[ P_{ij}^{AB} = ( 1.0 + \Kappa_B \cos(\theta_i^A - \theta_j^B) ) \]
</p>

<p>
and also low rank
</p>

<p>
\[ J_{ij}^{AB} = \frac{J_{AB}}{\sqrt{K_B}} with proba. P_{ij}^{AB} * \frac{K_B}{N_B} \]
\[ 0 otherwise \]
</p>
</div>
</li>

<li><a id="org414f601"></a>All to all<br>
<div class="outline-text-5" id="text-org414f601">
<p>
\[ J_{ij}^{AB} =  \frac{J_{AB}}{N_B} P_{ij}^{AB} \]
</p>

<p>
where Pij can be as above.
</p>
</div>
</li>
</ul>
</div>
</section>

<section id="outline-container-org93b7762" class="outline-2">
<h2 id="org93b7762">Network Simulations</h2>
<div class="outline-text-2" id="text-org93b7762">
</div>
<div id="outline-container-org3346688" class="outline-3">
<h3 id="org3346688">Basic Usage</h3>
<div class="outline-text-3" id="text-org3346688">
<p>
Here is how to run a simulation
</p>

<div class="org-src-container">
<pre class="src src-ipython"># import the network class
from src.network import Network

# Define repository root
repo_root = '/'

# Choose a config file
conf_file = './conf/conf_EI.yml'

# Other parameters can be overwriten with kwargs
# kwargs can be any of the args in the config file

# initialize model
model = Network(conf_file, repo_root, **kwargs)

# run a forward pass
rates = model()
</pre>
</div>
</div>
</div>

<div id="outline-container-orga62a82a" class="outline-3">
<h3 id="orga62a82a"><a href="file:///LeonCarmin/NeuroFlame/src/branch/main/org/doc/neurotorch.html">Parallel Network Simulations</a></h3>
<div class="outline-text-3" id="text-orga62a82a">
<p>
I describe in detail how to run a network simulation and use NeuroFlame to effectively run parallel simulations for different parameters <a href="file:///LeonCarmin/NeuroFlame/src/branch/main/org/doc/neurotorch.html">here</a>.
</p>
</div>
</div>
</section>

<section id="outline-container-org9eae4c2" class="outline-2">
<h2 id="org9eae4c2"><a href="file:///LeonCarmin/NeuroFlame/src/branch/main/org/train.html">Network Training</a></h2>
<div class="outline-text-2" id="text-org9eae4c2">
<p>
<a href="file:///LeonCarmin/NeuroFlame/src/branch/main/org/train.html">Here</a>, I show how to train networks.
</p>
</div>
</section>
<section id="outline-container-orge89b3d5" class="outline-2">
<h2 id="orge89b3d5">Tutorials</h2>
<div class="outline-text-2" id="text-orge89b3d5">
</div>
<div id="outline-container-org51bbf95" class="outline-3">
<h3 id="org51bbf95"><a href="file:///LeonCarmin/NeuroFlame/src/branch/main/org/tests/balance.html">Balanced Networks</a></h3>
<div class="outline-text-3" id="text-org51bbf95">
<p>
<a href="file:///LeonCarmin/NeuroFlame/src/branch/main/org/tests/balance.html">Here</a>, a tutorial on balanced networks.
</p>
</div>
</div>
<div id="outline-container-org88b3941" class="outline-3">
<h3 id="org88b3941"><a href="file:///LeonCarmin/NeuroFlame/src/branch/main/org/search/multi_stable.html">Multistability</a></h3>
<div class="outline-text-3" id="text-org88b3941">
</div>
<ul class="org-ul">
<li><a id="org07feff4"></a>Fully connected<br>
<div class="outline-text-5" id="text-org07feff4">
<p>
<a href="file:///LeonCarmin/NeuroFlame/src/branch/main/org/search/ring_attractor.html">Here</a>, a notebook that shows how to use NeuroFlame to locate ring attractors in parameter space.
</p>
</div>
</li>
<li><a id="orgbd73f81"></a>Sparse<br>
<div class="outline-text-5" id="text-orgbd73f81">
<p>
<a href="file:///LeonCarmin/NeuroFlame/src/branch/main/org/search/multi_stable.html">Here</a>, a notebook that shows how to use NeuroFlame to locate multistable balance states in parameter space.
</p>
</div>
</li>
</ul>
</div>

<div id="outline-container-org2820c64" class="outline-3">
<h3 id="org2820c64"><a href="file:///LeonCarmin/NeuroFlame/src/branch/main/org/tests/stp.html">Short Term Plasticity</a></h3>
<div class="outline-text-3" id="text-org2820c64">
<p>
<a href="file:///LeonCarmin/NeuroFlame/src/branch/main/org/tests/stp.html">Here</a>, a tutorial on STP with NeuroFlame.
</p>
</div>
</div>
<div id="outline-container-org61b3696" class="outline-3">
<h3 id="org61b3696"><a href="file:///LeonCarmin/NeuroFlame/src/branch/main/org/tests/stimuli.html">Behavioral Tasks</a></h3>
<div class="outline-text-3" id="text-org61b3696">
<p>
<a href="file:///LeonCarmin/NeuroFlame/src/branch/main/org/tests/stimuli.html">Here</a>, a tutorial on how to use different stimuli to get the model to perform different behavioral tasks.
</p>
</div>
</div>
<div id="outline-container-org9273547" class="outline-3">
<h3 id="org9273547"><a href="file:///LeonCarmin/NeuroFlame/src/branch/main/org/serial_bias.html">Serial Bias</a></h3>
<div class="outline-text-3" id="text-org9273547">
<p>
<a href="file:///LeonCarmin/NeuroFlame/src/branch/main/org/serial_bias.html">Here</a>, a tutorial on how to get serial bias in a balanced network model.
</p>
</div>
</div>
</section>

<section id="outline-container-org564e8b2" class="outline-2">
<h2 id="org564e8b2">Contributing</h2>
<div class="outline-text-2" id="text-org564e8b2">
<p>
Feel free to contribute.
</p>

<pre class="example" id="orgb056219">
MIT License
Copyright (c) [2023] [A. Mahrach]
</pre>
</div>
</section>
</main>
<footer id="postamble" class="status">
<p class="author">Author: Alexandre Mahrach</p>
<p class="date">Created: 26 Apr. 2024</p>
</footer>
</body>
</html>
